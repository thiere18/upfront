{"version":3,"sources":["utils/auth.ts","views/Home.tsx","views/Login.tsx","views/SignUp.tsx","views/Protected.tsx","views/PrivateRoute.tsx","admin/authProvider.ts","admin/Users/UserEdit.tsx","admin/Users/UserList.tsx","admin/Users/UserCreate.tsx","admin/Admin.tsx","Routes.tsx","App.tsx","index.tsx"],"names":["isAuthenticated","permissions","localStorage","getItem","login","email","password","a","length","Error","formData","FormData","append","request","Request","method","body","fetch","response","status","json","data","detail","decodedToken","decodeJwt","setItem","signUp","passwordConfirmation","useStyles","makeStyles","theme","link","color","Home","useState","classes","className","href","margin","spacing","padding","button","textTransform","marginTop","Login","history","useHistory","setEmail","setPassword","error","setError","handleSubmit","_","push","message","String","to","Paper","Grid","container","alignItems","item","Face","md","sm","xs","TextField","id","label","type","value","onChange","e","currentTarget","fullWidth","autoFocus","required","Fingerprint","Alert","severity","justify","FormControlLabel","control","Checkbox","Button","disableFocusRipple","disableRipple","variant","onClick","SignUp","setPasswordConfirmation","Protected","PrivateRoute","component","rest","render","props","React","createElement","authProvider","username","then","statusText","access_token","logout","removeItem","Promise","resolve","checkError","reject","checkAuth","getPermissions","role","CT_SELECT_I18N","text","UserEdit","Edit","SimpleForm","TextInput","disabled","source","PasswordInput","SelectInput","choices","translateChoice","optionValue","optionText","BooleanInput","UserList","usePermissions","List","Datagrid","rowClick","EmailField","BooleanField","EditButton","DeleteButton","basePath","UserCreate","Create","dataProvider","simpleRestProvider","url","options","headers","Headers","Accept","token","set","fetchUtils","fetchJson","Admin","Resource","name","list","edit","create","app","textAlign","header","backgroundColor","minHeight","display","flexDirection","justifyContent","fontSize","Routes","path","exact","App","ReactDOM","document","getElementById"],"mappings":"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","file":"static/js/main.fc950628.chunk.js","sourcesContent":["import decodeJwt from 'jwt-decode';\n\nexport const isAuthenticated = () => {\n  const permissions = localStorage.getItem('permissions');\n  if (!permissions) {\n    return false;\n  }\n  return permissions === 'user' || permissions === 'admin' ? true : false;\n};\n\n/**\n * Login to backend and store JSON web token on success\n *\n * @param email\n * @param password\n * @returns JSON data containing access token on success\n * @throws Error on http errors or failed attempts\n */\nexport const login = async (email: string, password: string) => {\n  // Assert email or password is not empty\n  if (!(email.length > 0) || !(password.length > 0)) {\n    throw new Error('Email or password was not provided');\n  }\n  const formData = new FormData();\n  // OAuth2 expects form data, not JSON data\n  formData.append('username', email);\n  formData.append('password', password);\n\n  const request = new Request('http://back.thiere18.studio/api/token', {\n    method: 'POST',\n    body: formData,\n  });\n\n  const response = await fetch(request);\n\n  if (response.status === 500) {\n    throw new Error('Internal server error');\n  }\n\n  const data = await response.json();\n\n  if (response.status > 400 && response.status < 500) {\n    if (data.detail) {\n      throw data.detail;\n    }\n    throw data;\n  }\n\n  if ('access_token' in data) {\n    const decodedToken: any = decodeJwt(data['access_token']);\n    localStorage.setItem('token', data['access_token']);\n    localStorage.setItem('permissions', decodedToken.permissions);\n  }\n\n  return data;\n};\n\n/**\n * Sign up via backend and store JSON web token on success\n *\n * @param email\n * @param password\n * @returns JSON data containing access token on success\n * @throws Error on http errors or failed attempts\n */\nexport const signUp = async (\n  email: string,\n  password: string,\n  passwordConfirmation: string\n) => {\n  // Assert email or password or password confirmation is not empty\n  if (!(email.length > 0)) {\n    throw new Error('Email was not provided');\n  }\n  if (!(password.length > 0)) {\n    throw new Error('Password was not provided');\n  }\n  if (!(passwordConfirmation.length > 0)) {\n    throw new Error('Password confirmation was not provided');\n  }\n\n  const formData = new FormData();\n  // OAuth2 expects form data, not JSON data\n  formData.append('username', email);\n  formData.append('password', password);\n\n  const request = new Request('/api/signup', {\n    method: 'POST',\n    body: formData,\n  });\n\n  const response = await fetch(request);\n\n  if (response.status === 500) {\n    throw new Error('Internal server error');\n  }\n\n  const data = await response.json();\n  if (response.status > 400 && response.status < 500) {\n    if (data.detail) {\n      throw data.detail;\n    }\n    throw data;\n  }\n\n  if ('access_token' in data) {\n    const decodedToken: any = decodeJwt(data['access_token']);\n    localStorage.setItem('token', data['access_token']);\n    localStorage.setItem('permissions', decodedToken.permissions);\n  }\n\n  return data;\n};\n\nexport const logout = () => {\n  localStorage.removeItem('token');\n  localStorage.removeItem('permissions');\n};\n","import React, { FC, useState } from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\n\nimport { getMessage } from '../utils/api';\nimport { isAuthenticated } from '../utils/auth';\n\nconst useStyles = makeStyles((theme) => ({\n  link: {\n    color: '#61dafb',\n  },\n}));\n\nexport const Home: FC = () => {\n  const [message, setMessage] = useState<string>('');\n  const [error, setError] = useState<string>('');\n  const classes = useStyles();\n\n  const queryBackend = async () => {\n    try {\n      const message = await getMessage();\n      setMessage(message);\n    } catch (err) {\n      setError(String(err));\n    }\n  };\n\n  return (\n    <>\n\n     \n      {isAuthenticated() ? (\n        <>\n        <a className={classes.link} href=\"/logout\">\n          Logout\n          </a>\n          <a className={classes.link} href=\"/admin\">\n          Dashboard\n        </a>\n          </>\n      ) : (\n        <>\n          <a className={classes.link} href=\"/login\">\n            Login\n          </a>\n          <a className={classes.link} href=\"/signup\">\n            Sign Up\n          </a>\n        </>\n      )}\n    </>\n  );\n};\n","import React, { FC, useState } from 'react';\nimport {\n  Paper,\n  Grid,\n  TextField,\n  Button,\n  FormControlLabel,\n  Checkbox,\n} from '@material-ui/core';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { Face, Fingerprint } from '@material-ui/icons';\nimport { Alert } from '@material-ui/lab';\nimport { Redirect } from 'react-router-dom';\nimport { useHistory } from 'react-router';\n\nimport { login, isAuthenticated } from '../utils/auth';\n\nconst useStyles = makeStyles((theme) => ({\n  margin: {\n    margin: theme.spacing(2),\n  },\n  padding: {\n    padding: theme.spacing(1),\n  },\n  button: {\n    textTransform: 'none',\n  },\n  marginTop: {\n    marginTop: 10,\n  },\n}));\n\nexport const Login: FC = () => {\n  const classes = useStyles();\n  const history = useHistory();\n  const [email, setEmail] = useState<string>('');\n  const [password, setPassword] = useState<string>('');\n  const [error, setError] = useState<string>('');\n\n  const handleSubmit = async (_: React.MouseEvent) => {\n    setError('');\n    try {\n      const data = await login(email, password);\n\n      if (data) {\n        history.push('/');\n      }\n    } catch (err) {\n      if (err instanceof Error) {\n        // handle errors thrown from frontend\n        setError(err.message);\n      } else {\n        // handle errors thrown from backend\n        setError(String(err));\n      }\n    }\n  };\n\n  return isAuthenticated() ? (\n    <Redirect to=\"/\" />\n  ) : (\n    <Paper className={classes.padding}>\n      <div className={classes.margin}>\n        <Grid container spacing={8} alignItems=\"flex-end\">\n          <Grid item>\n            <Face />\n          </Grid>\n          <Grid item md={true} sm={true} xs={true}>\n            <TextField\n              id=\"email\"\n              label=\"Email\"\n              type=\"email\"\n              value={email}\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\n                setEmail(e.currentTarget.value)\n              }\n              fullWidth\n              autoFocus\n              required\n            />\n          </Grid>\n        </Grid>\n        <Grid container spacing={8} alignItems=\"flex-end\">\n          <Grid item>\n            <Fingerprint />\n          </Grid>\n          <Grid item md={true} sm={true} xs={true}>\n            <TextField\n              id=\"password\"\n              label=\"Password\"\n              type=\"password\"\n              value={password}\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\n                setPassword(e.currentTarget.value)\n              }\n              fullWidth\n              required\n            />\n          </Grid>\n        </Grid>\n        <br />\n        <Grid container alignItems=\"center\">\n          {error && (\n            <Grid item>\n              <Alert severity=\"error\">{error}</Alert>\n            </Grid>\n          )}\n        </Grid>\n        <Grid container alignItems=\"center\" justify=\"space-between\">\n          <Grid item>\n            <FormControlLabel\n              control={<Checkbox color=\"primary\" />}\n              label=\"Remember me\"\n            />\n          </Grid>\n          <Grid item>\n            <Button\n              disableFocusRipple\n              disableRipple\n              className={classes.button}\n              variant=\"text\"\n              color=\"primary\"\n            >\n              Forgot password ?\n            </Button>\n          </Grid>\n        </Grid>\n        <Grid container justify=\"center\" className={classes.marginTop}>\n          {' '}\n          <Button\n            variant=\"outlined\"\n            color=\"primary\"\n            className={classes.button}\n            onClick={() => history.push('/signup')}\n          >\n            Sign Up\n          </Button>{' '}\n          &nbsp;\n          <Button\n            variant=\"outlined\"\n            color=\"primary\"\n            className={classes.button}\n            onClick={handleSubmit}\n          >\n            Login\n          </Button>\n        </Grid>\n      </div>\n    </Paper>\n  );\n};\n","import React, { FC, useState } from 'react';\nimport { Paper, Grid, TextField, Button } from '@material-ui/core';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { Face, Fingerprint } from '@material-ui/icons';\nimport { Alert } from '@material-ui/lab';\nimport { Redirect } from 'react-router-dom';\nimport { useHistory } from 'react-router';\n\nimport { signUp, isAuthenticated } from '../utils/auth';\n\nconst useStyles = makeStyles((theme) => ({\n  margin: {\n    margin: theme.spacing(2),\n  },\n  padding: {\n    padding: theme.spacing(1),\n  },\n  button: {\n    textTransform: 'none',\n  },\n  marginTop: {\n    marginTop: 10,\n  },\n}));\n\nexport const SignUp: FC = () => {\n  const classes = useStyles();\n  const history = useHistory();\n  const [email, setEmail] = useState<string>('');\n  const [password, setPassword] = useState<string>('');\n  const [passwordConfirmation, setPasswordConfirmation] = useState<string>('');\n  const [error, setError] = useState<string>('');\n\n  const handleSubmit = async (_: React.MouseEvent) => {\n    // Password confirmation validation\n    if (password !== passwordConfirmation) setError('Passwords do not match');\n    else {\n      setError('');\n      try {\n        const data = await signUp(email, password, passwordConfirmation);\n\n        if (data) {\n          history.push('/');\n        }\n      } catch (err) {\n        if (err instanceof Error) {\n          // handle errors thrown from frontend\n          setError(err.message);\n        } else {\n          // handle errors thrown from backend\n          setError(String(err));\n        }\n      }\n    }\n  };\n\n  return isAuthenticated() ? (\n    <Redirect to=\"/\" />\n  ) : (\n    <Paper className={classes.padding}>\n      <div className={classes.margin}>\n        <Grid container spacing={8} alignItems=\"flex-end\">\n          <Grid item>\n            <Face />\n          </Grid>\n          <Grid item md={true} sm={true} xs={true}>\n            <TextField\n              id=\"email\"\n              label=\"Email\"\n              type=\"email\"\n              value={email}\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\n                setEmail(e.currentTarget.value)\n              }\n              fullWidth\n              autoFocus\n              required\n            />\n          </Grid>\n        </Grid>\n        <Grid container spacing={8} alignItems=\"flex-end\">\n          <Grid item>\n            <Fingerprint />\n          </Grid>\n          <Grid item md={true} sm={true} xs={true}>\n            <TextField\n              id=\"password\"\n              label=\"Password\"\n              type=\"password\"\n              value={password}\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\n                setPassword(e.currentTarget.value)\n              }\n              fullWidth\n              required\n            />\n          </Grid>\n        </Grid>\n        <Grid container spacing={8} alignItems=\"flex-end\">\n          <Grid item>\n            <Fingerprint />\n          </Grid>\n          <Grid item md={true} sm={true} xs={true}>\n            <TextField\n              id=\"passwordConfirmation\"\n              label=\"Confirm password\"\n              type=\"password\"\n              value={passwordConfirmation}\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\n                setPasswordConfirmation(e.currentTarget.value)\n              }\n              fullWidth\n              required\n            />\n          </Grid>\n        </Grid>\n        <br />\n        <Grid container alignItems=\"center\">\n          {error && (\n            <Grid item>\n              <Alert severity=\"error\">{error}</Alert>\n            </Grid>\n          )}\n        </Grid>\n        <Grid container justify=\"center\" className={classes.marginTop}>\n          <Button\n            variant=\"outlined\"\n            color=\"primary\"\n            className={classes.button}\n            onClick={handleSubmit}\n          >\n            Sign Up\n          </Button>\n        </Grid>\n      </div>\n    </Paper>\n  );\n};\n","import React, { FC } from 'react';\n\nexport const Protected: FC = () => {\n  return <h1>This component is protected</h1>;\n};\n","import React, { FC } from 'react';\nimport { Route, Redirect } from 'react-router-dom';\n\nimport { isAuthenticated } from '../utils/auth';\n\ntype PrivateRouteType = {\n  component: React.ComponentType<any>;\n  path?: string | string[];\n};\n\nexport const PrivateRoute: FC<PrivateRouteType> = ({\n  component,\n  ...rest\n}: any) => (\n  <Route\n    {...rest}\n    render={(props: any) =>\n      isAuthenticated() === true ? (\n        React.createElement(component, props)\n      ) : (\n        <Redirect to=\"/login\" />\n      )\n    }\n  />\n);\n","import decodeJwt from 'jwt-decode';\n\ntype loginFormType = {\n  username: string;\n  password: string;\n};\n\nconst authProvider = {\n  login: ({ username, password }: loginFormType) => {\n    let formData = new FormData();\n    formData.append('username', username);\n    formData.append('password', password);\n    const request = new Request('http://back.thiere18.studio/api/token', {\n      method: 'POST',\n      body: formData,\n    });\n    return fetch(request)\n      .then((response) => {\n        if (response.status < 200 || response.status >= 300) {\n          throw new Error(response.statusText);\n        }\n        return response.json();\n      })\n      .then(({ access_token }) => {\n        const decodedToken: any = decodeJwt(access_token);\n        if (decodedToken.permissions === 'restricted'  ) {\n          throw new Error('Forbidden');\n        }\n        localStorage.setItem('token', access_token);\n        localStorage.setItem('permissions', decodedToken.permissions);\n      });\n  },\n  logout: () => {\n    localStorage.removeItem('token');\n    localStorage.removeItem('permissions');\n    return Promise.resolve();\n  },\n  checkError: (error: { status: number }) => {\n    const status = error.status;\n    if (status === 401 || status === 403) {\n      localStorage.removeItem('token');\n      return Promise.reject();\n    }\n    return Promise.resolve();\n  },\n  checkAuth: () =>\n    localStorage.getItem('token') ? Promise.resolve() : Promise.reject(),\n  getPermissions: () => {\n    const role = localStorage.getItem('permissions');\n    return role ? Promise.resolve(role) : Promise.reject();\n    // localStorage.getItem('token') ? Promise.resolve() : Promise.reject(),\n  },\n};\n\nexport default authProvider;\n","import React, { FC } from 'react';\nimport {\n  Edit,\n  SimpleForm,\n  TextInput,\n  PasswordInput,\n  BooleanInput,\n  SelectInput\n} from 'react-admin';\nexport const CT_SELECT_I18N = [\n  {id: 'admin', text: 'Admin'},\n  { id: 'normal', text: 'Normal' },\n  {id: 'restricted', text: 'Restricted'},\n\n];\nexport const UserEdit: FC = (props) => (\n  <Edit {...props}>\n    <SimpleForm>\n      <TextInput disabled source=\"id\" />\n      <TextInput source=\"username\" />\n      <TextInput source=\"email\" />\n      <TextInput source=\"first_name\" />\n      <TextInput source=\"last_name\" />\n      <PasswordInput source=\"password\" />\n      <SelectInput\n        source=\"role\"\n        choices={CT_SELECT_I18N}\n        translateChoice={false}\n        optionValue=\"id\"\n        optionText=\"text\"\n      />\n      <BooleanInput source=\"is_active\" />\n    </SimpleForm>\n  </Edit>\n);\n","// in src/users.js\nimport React, { FC } from 'react';\n// import { usePermissions } from 'react-admin';\nimport { usePermissions } from 'react-admin';\n\nimport {\n  List,\n  Datagrid,\n  TextField,\n  BooleanField,\n  EmailField,\n  EditButton,\n  DeleteButton\n} from 'react-admin';\n// const { loading, permissions } = usePermissions();\n\nexport const UserList: FC = (props) => {\n  const { permissions } = usePermissions();\n\n  return (\n    <>\n      <List {...props}>\n        <Datagrid rowClick=\"edit\">\n          <TextField source=\"id\" />\n          <TextField source=\"username\" />\n          <EmailField source=\"email\" />\n          <TextField source=\"first_name\" />\n          <TextField source=\"last_name\" />\n          <BooleanField source=\"is_active\" />\n          <TextField source=\"role\" />\n          {permissions==='admin'&& <EditButton />}\n          {permissions === 'admin' && <DeleteButton basePath=\"/users\" /> }\n\n        </Datagrid>\n      </List>\n    </>\n  )\n};\n","import React, { FC } from 'react';\nimport {\n  Create,\n  SimpleForm,\n  TextInput,\n  PasswordInput,\n  BooleanInput,\n  ReferenceInput,\n  SelectInput, SelectField,\n  O\n} from 'react-admin';\nimport { CT_SELECT_I18N } from './UserEdit';\n\n\nexport const UserCreate: FC = (props) => (\n  <Create {...props}>\n    <SimpleForm>\n    <TextInput source=\"username\" />\n      <TextInput source=\"email\" />\n      <TextInput source=\"first_name\" />\n      <TextInput source=\"last_name\" />\n      <PasswordInput source=\"password\" />\n\n      <SelectInput\n        source=\"role\"\n        choices={CT_SELECT_I18N}\n        translateChoice={false}\n        optionValue=\"id\"\n        optionText=\"text\"\n    />\n\n      <BooleanInput source=\"is_active\" />\n\n\n    </SimpleForm>\n  </Create>\n);\n","import React, { FC } from 'react';\nimport { fetchUtils, Admin as ReactAdmin, Resource } from 'react-admin';\nimport simpleRestProvider from 'ra-data-simple-rest';\nimport authProvider from './authProvider';\n\nimport { UserList, UserEdit, UserCreate } from './Users';\n\nconst httpClient = (url: any, options: any) => {\n  if (!options) {\n    options = {};\n  }\n  if (!options.headers) {\n    options.headers = new Headers({ Accept: 'application/json' });\n  }\n  const token = localStorage.getItem('token');\n  options.headers.set('Authorization', `Bearer ${token}`);\n  return fetchUtils.fetchJson(url, options);\n};\n\nconst dataProvider = simpleRestProvider('http://back.thiere18.studio/api/v1', httpClient);\n\nexport const Admin: FC = () => {\n  return (\n    <ReactAdmin dataProvider={dataProvider} authProvider={authProvider}>\n      {(permissions: 'admin' | 'normal'| 'restricted') => [\n        permissions === 'admin' ? (\n          <Resource\n            name=\"users\"\n            list={UserList}\n            edit={UserEdit}\n            create={UserCreate}\n\n          />\n        ) :     (   <Resource\n        name=\"users\"\n        list={UserList}\n        // edit={UserEdit}\n        // create={UserCreate}\n\n      />),\n      ]}\n    </ReactAdmin>\n  );\n};\n","import React, { FC } from 'react';\nimport { Switch, Route } from 'react-router-dom';\nimport { useHistory } from 'react-router';\nimport { makeStyles } from '@material-ui/core/styles';\n\nimport { Home, Login, SignUp, Protected, PrivateRoute } from './views';\nimport { Admin } from './admin';\nimport { logout } from './utils/auth';\n\nconst useStyles = makeStyles((theme) => ({\n  app: {\n    textAlign: 'center',\n  },\n  header: {\n    backgroundColor: '#282c34',\n    minHeight: '100vh',\n    display: 'flex',\n    flexDirection: 'column',\n    alignItems: 'center',\n    justifyContent: 'center',\n    fontSize: 'calc(10px + 2vmin)',\n    color: 'white',\n  },\n}));\n\nexport const Routes: FC = () => {\n  const classes = useStyles();\n  const history = useHistory();\n\n  return (\n    <Switch>\n      <Route path=\"/admin\">\n        <Admin />\n      </Route>\n\n      <div className={classes.app}>\n        <header className={classes.header}>\n          <Route path=\"/login\" component={Login} />\n          <Route path=\"/signup\" component={SignUp} />\n          <Route\n            path=\"/logout\"\n            render={() => {\n              logout();\n              history.push('/');\n              return null;\n            }}\n          />\n          <PrivateRoute path=\"/protected\" component={Protected} />\n          <Route exact path=\"/\" component={Home} />\n        </header>\n      </div>\n    </Switch>\n  );\n};\n","import React, { FC } from 'react';\nimport { Routes } from './Routes';\n\nconst App: FC = () => <Routes />;\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { BrowserRouter as Router } from 'react-router-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(\n  <Router>\n    <App />\n  </Router>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}